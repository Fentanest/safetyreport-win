# 안전신문고 자동 크롤러

안전신문고 웹사이트의 신고 내역을 자동으로 크롤링하고 관리하는 시스템입니다.

## 주요 기능

- **자동 크롤링**: 안전신문고에 자동으로 로그인하여 모든 신고 내역(요약 및 상세)을 크롤링합니다.
- **데이터베이스 관리**:
    - 크롤링한 데이터를 SQLite 데이터베이스에 체계적으로 저장합니다.
    - **자동 스키마 마이그레이션**: 애플리케이션 업데이트 시, 기존 데이터를 유지하면서 DB 테이블에 누락된 컬럼을 자동으로 추가합니다.
- **첨부파일 관리**:
    - 상세 정보 파싱 시, 일반 첨부파일과 이미지 첨부파일(첨부사진)을 자동으로 분리하여 저장합니다.
    - **오래된 링크 정리**: 6개월이 지난 신고 건의 지도, 첨부사진, 첨부파일 링크를 "6개월 초과"로 자동 변경하여 관리합니다.
- **데이터 내보내기**:
    - **Excel**: 전체 데이터를 서식이 적용된 Excel 파일로 저장합니다.
    - **Google Sheets**: Google Sheets API와 연동하여 결과를 스프레드시트로 저장합니다.
        - 지도 및 첨부사진은 `=image()` 함수를 통해 이미지 미리보기를 제공합니다.
        - 이미지 가독성을 위해 데이터 행의 높이가 자동으로 조절됩니다.
- **텔레그램 봇 연동**:
    - 크롤링, 엑셀 저장 등 주요 기능을 원격으로 실행할 수 있습니다.
    - 차량 번호의 일부만으로도 관련 신고 내역을 검색할 수 있습니다.
    - 모든 작업 완료 시 텔레그램으로 알림을 받습니다.
- **유연한 설정**: 
    - Docker 환경변수를 통해 주요 환경값을 설정할 수 있습니다.

---

### 1. 실행 파일 다운로드

Github에서 단일 실행파일을 다운로드 받아 실행합니다.

### 2. ID/PW입력

UI에서 아이디와 비밀번호를 입력하고 `크롤링 시작`을 클릭합니다.

### 3. 부가기능 사용

`Alt+O`를 이용하여 옵션창을 연 뒤 구글 스프레드 시트와 텔레그램 봇 기능을 설정합니다.

구글 스프레드시트를 사용하기 위해선, 스프레드시트 API인증을 위한 JSON파일과 권한이 설정된 스프레드시트의 주소값이 필요합니다.

[JSON파일 및 스프레드시트 권한설정 방법](https://sseozytank.tistory.com/74)

스프레드시트의 주소는 `https://docs.google.com/spreadsheets/d/abcdefghijklmnopqrstuvwxyz/` 일 경우 `abcdefghijklmnopqrstuvwxyz`를 사용하면 됩니다.

텔레그램 봇을 설정하고 프로그램이 실행되어 있다면,

텔레그램 봇을 통해 크롤링 지시, 누적된 데이터를 통한 차량검색 기능 등을 사용할 수 있습니다.

텔레그램 봇은 `/h`로 호출합니다.
